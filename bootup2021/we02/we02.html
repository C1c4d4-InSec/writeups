<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="styles.css">
        <title>we02 - 2021 SANs Bootup CTF</title>
    </head>
    <body>
<div id="menu">
    <div id="pageTitle"><h1> c1cada@insec </h1></div>
    <div id="menuLinks"><hr>
        <a href="../index.html"><b>Index</b></a> | 
        <a href="../be01/be01.html">be01</a> | 
        <a href="../be03/be03.html">be03</a> | 
        <a href="../ce01/ce01.html">ce01</a> | 
        <a href="../ce02/ce02.html">ce02</a> | 
        <a href="../ce03/ce03.html">ce03</a> | 
        <a href="../ch01/ch01.html">ch01</a> | 
        <a href="../fe01/fe01.html">fe01</a> | 
        <a href="../fe02/fe02.html">fe02</a> | 
        <a href="../fe03/fe03.html">fe04</a> |
        <a href="../fe04/fe04.html">fe04</a> |
        <a href="../fm01/fm01.html">fm01</a> | 
        <a href="../fm02/fm02.html">fm02</a> | 
        <a href="../fh01/fh01.html">fh01</a> | 
        <a href="../we01-1/we01-1.html">we01-1</a> | 
        <a href="../we01/we01.html">we01</a> | 
        <a href="../we02/we02.html">we02</a> | 
        <a href="../we03/we03.html">we03</a> | 
        <a href="../wm01/wm01.html">wm01</a> | 
        <a href="../wm02/wm02.html">wm02</a>
    <hr></div>
</div>

<div id="body">

This challenge presents a simple log in form.
Inspect the page!
There is some javascript located in the header.
<img src='we0201.PNG'>

Reading through the code, there is a section with the flag encoded at the bottom.
The next script seems to be the authorization code. With the username 'root' and the password algorithm.
It can't be that easy, can it?

Here is the interesting part.

---
        var c = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        var d = "";
        var i = 6;
        var y = 0;
        var l = 3;
        var n = 44;
        
        while (y < n) {
            d += c[(i*y)%61];
            i = c.charCodeAt(d)%61;
            y+=l;
        }
---

The javascript is already written for me, so I am going to put that code into a web app and print out d.
Miliseconds later I am greeted with the password.
<img src='we0202.PNG'>

Upon entering the password into the form, the flag is shown.
<img src='we0203.PNG'>

